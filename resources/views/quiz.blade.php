<x-game-layout>
{{--    <!-- Features -->--}}
{{--    <div class="max-w-[85rem] px-4 py-10 sm:px-6 lg:px-8 lg:py-14 mx-auto over">--}}
{{--        <div class="relative p-6 md:p-16 overflow-hidden">--}}
{{--            <!-- Grid -->--}}
{{--            <div class="relative z-10 lg:grid lg:grid-cols-12 lg:gap-16 lg:items-center">--}}
{{--                <div class="mb-10 lg:mb-0 lg:col-span-6 lg:col-start-8 lg:order-2">--}}
{{--                    <h2 class="text-2xl text-gray-800 font-bold sm:text-3xl dark:text-neutral-200">--}}
{{--                        Fully customizable rules to match your unique needs--}}
{{--                    </h2>--}}

{{--                    <!-- Tab Navs -->--}}
{{--                    <nav class="grid gap-4 mt-5 md:mt-10" aria-label="Tabs" role="tablist" aria-orientation="vertical">--}}
{{--                        <button type="button"--}}
{{--                                class="hs-tab-active:bg-white hs-tab-active:shadow-md hs-tab-active:hover:border-transparent text-start hover:bg-gray-200 focus:outline-hidden focus:bg-gray-200 p-4 md:p-5 rounded-xl dark:hs-tab-active:bg-neutral-700 dark:hover:bg-neutral-700 dark:focus:bg-neutral-700 active"--}}
{{--                                id="tabs-with-card-item-1" aria-selected="true" data-hs-tab="#tabs-with-card-1"--}}
{{--                                aria-controls="tabs-with-card-1" role="tab">--}}
{{--                        <span class="flex gap-x-6">--}}
{{--                          <svg--}}
{{--                              class="shrink-0 mt-2 size-6 md:size-7 hs-tab-active:text-blue-600 text-gray-800 dark:hs-tab-active:text-blue-500 dark:text-neutral-200"--}}
{{--                              xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"--}}
{{--                              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path--}}
{{--                                  d="M5 5.5A3.5 3.5 0 0 1 8.5 2H12v7H8.5A3.5 3.5 0 0 1 5 5.5z"/><path--}}
{{--                                  d="M12 2h3.5a3.5 3.5 0 1 1 0 7H12V2z"/><path--}}
{{--                                  d="M12 12.5a3.5 3.5 0 1 1 7 0 3.5 3.5 0 1 1-7 0z"/><path--}}
{{--                                  d="M5 19.5A3.5 3.5 0 0 1 8.5 16H12v3.5a3.5 3.5 0 1 1-7 0z"/><path--}}
{{--                                  d="M5 12.5A3.5 3.5 0 0 1 8.5 9H12v7H8.5A3.5 3.5 0 0 1 5 12.5z"/></svg>--}}
{{--                          <span class="grow">--}}
{{--                            <span--}}
{{--                                class="block text-lg font-semibold hs-tab-active:text-blue-600 text-gray-800 dark:hs-tab-active:text-blue-500 dark:text-neutral-200">Advanced tools</span>--}}
{{--                            <span--}}
{{--                                class="block mt-1 text-gray-800 dark:hs-tab-active:text-gray-200 dark:text-neutral-200">Use Preline thoroughly thought and automated libraries to manage your businesses.</span>--}}
{{--                          </span>--}}
{{--                        </span>--}}
{{--                        </button>--}}

{{--                        <div--}}
{{--                                class="hs-tab-active:bg-white hs-tab-active:shadow-md hs-tab-active:hover:border-transparent text-start hover:bg-gray-200 focus:outline-hidden focus:bg-gray-200 p-4 md:p-5 rounded-xl dark:hs-tab-active:bg-neutral-700 dark:hover:bg-neutral-700 dark:focus:bg-neutral-700"--}}
{{--                                id="tabs-with-card-item-2" aria-selected="false" data-hs-tab="#tabs-with-card-2"--}}
{{--                                aria-controls="tabs-with-card-2" role="tab">--}}
{{--                            <!-- Card Section -->--}}
{{--                            <div class="max-w-5xl px-4 py-10 sm:px-6 lg:px-8 lg:py-14 mx-auto">--}}
{{--                                <!-- Grid -->--}}
{{--                                <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-6">--}}
{{--                                    <!-- Card -->--}}
{{--                                    <a class="group flex flex-col bg-white border shadow-xs rounded-xl hover:shadow-md focus:outline-hidden focus:shadow-md transition dark:bg-neutral-900 dark:border-neutral-800" href="#">--}}
{{--                                        <div class="p-4 md:p-5">--}}
{{--                                            <div class="flex gap-x-5">--}}
{{--                                                <svg class="mt-1 shrink-0 size-5 text-gray-800 dark:text-neutral-200" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>--}}

{{--                                                <div class="grow">--}}
{{--                                                    <h3 class="group-hover:text-blue-600 font-semibold text-gray-800 dark:group-hover:text-neutral-400 dark:text-neutral-200">--}}
{{--                                                        Ask our community--}}
{{--                                                    </h3>--}}
{{--                                                    <p class="text-sm text-gray-500 dark:text-neutral-500">--}}
{{--                                                        Get help from 40k+ Preline users--}}
{{--                                                    </p>--}}
{{--                                                </div>--}}
{{--                                            </div>--}}
{{--                                        </div>--}}
{{--                                    </a>--}}
{{--                                    <!-- End Card -->--}}

{{--                                    <!-- Card -->--}}
{{--                                    <a class="group flex flex-col bg-white border shadow-xs rounded-xl hover:shadow-md focus:outline-hidden focus:shadow-md transition dark:bg-neutral-900 dark:border-neutral-800" href="#">--}}
{{--                                        <div class="p-4 md:p-5">--}}
{{--                                            <div class="flex gap-x-5">--}}
{{--                                                <svg class="mt-1 shrink-0 size-5 text-gray-800 dark:text-neutral-200" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/></svg>--}}

{{--                                                <div class="grow">--}}
{{--                                                    <h3 class="group-hover:text-blue-600 font-semibold text-gray-800 dark:group-hover:text-neutral-400 dark:text-neutral-200">--}}
{{--                                                        Get help in the app--}}
{{--                                                    </h3>--}}
{{--                                                    <p class="text-sm text-gray-500 dark:text-neutral-500">--}}
{{--                                                        Just head to «Help» in the app--}}
{{--                                                    </p>--}}
{{--                                                </div>--}}
{{--                                            </div>--}}
{{--                                        </div>--}}
{{--                                    </a>--}}
{{--                                    <!-- End Card -->--}}

{{--                                    <!-- Card -->--}}
{{--                                    <a class="group flex flex-col bg-white border shadow-xs rounded-xl hover:shadow-md focus:outline-hidden focus:shadow-md transition dark:bg-neutral-900 dark:border-neutral-800" href="#">--}}
{{--                                        <div class="p-4 md:p-5">--}}
{{--                                            <div class="flex gap-x-5">--}}
{{--                                                <svg class="mt-1 shrink-0 size-5 text-gray-800 dark:text-neutral-200" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.2 8.4c.5.38.8.97.8 1.6v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V10a2 2 0 0 1 .8-1.6l8-6a2 2 0 0 1 2.4 0l8 6Z"/><path d="m22 10-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 10"/></svg>--}}

{{--                                                <div class="grow">--}}
{{--                                                    <h3 class="group-hover:text-blue-600 font-semibold text-gray-800 dark:group-hover:text-neutral-400 dark:text-neutral-200">--}}
{{--                                                        Email us--}}
{{--                                                    </h3>--}}
{{--                                                    <p class="text-sm text-gray-500 dark:text-neutral-500">--}}
{{--                                                        Reach us at <span class="text-blue-600 decoration-2 group-hover:underline font-medium dark:text-blue-500">info@site.com</span>--}}
{{--                                                    </p>--}}
{{--                                                </div>--}}
{{--                                            </div>--}}
{{--                                        </div>--}}
{{--                                    </a>--}}
{{--                                    <!-- End Card -->--}}
{{--                                </div>--}}
{{--                                <!-- End Grid -->--}}
{{--                            </div>--}}
{{--                            <!-- End Card Section -->--}}
{{--                        </div>--}}

{{--                        <button type="button"--}}
{{--                                class="hs-tab-active:bg-white hs-tab-active:shadow-md hs-tab-active:hover:border-transparent text-start hover:bg-gray-200 focus:outline-hidden focus:bg-gray-200 p-4 md:p-5 rounded-xl dark:hs-tab-active:bg-neutral-700 dark:hover:bg-neutral-700 dark:focus:bg-neutral-700"--}}
{{--                                id="tabs-with-card-item-3" aria-selected="false" data-hs-tab="#tabs-with-card-3"--}}
{{--                                aria-controls="tabs-with-card-3" role="tab">--}}
{{--            <span class="flex gap-x-6">--}}
{{--              <svg--}}
{{--                  class="shrink-0 mt-2 size-6 md:size-7 hs-tab-active:text-blue-600 text-gray-800 dark:hs-tab-active:text-blue-500 dark:text-neutral-200"--}}
{{--                  xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"--}}
{{--                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path--}}
{{--                      d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/><path--}}
{{--                      d="M5 3v4"/><path d="M19 17v4"/><path d="M3 5h4"/><path d="M17 19h4"/></svg>--}}
{{--              <span class="grow">--}}
{{--                <span--}}
{{--                    class="block text-lg font-semibold hs-tab-active:text-blue-600 text-gray-800 dark:hs-tab-active:text-blue-500 dark:text-neutral-200">Powerful features</span>--}}
{{--                <span class="block mt-1 text-gray-800 dark:hs-tab-active:text-gray-200 dark:text-neutral-200">Reduce time and effort on building modern look design with Preline only.</span>--}}
{{--              </span>--}}
{{--            </span>--}}
{{--                        </button>--}}
{{--                    </nav>--}}
{{--                    <!-- End Tab Navs -->--}}
{{--                </div>--}}
{{--                <!-- End Col -->--}}

{{--                <div class="lg:col-span-6">--}}
{{--                    <div class="relative">--}}
{{--                        <!-- Tab Content -->--}}
{{--                        <div>--}}
{{--                            <div id="tabs-with-card-1" role="tabpanel" aria-labelledby="tabs-with-card-item-1">--}}
{{--                                <img class="shadow-xl shadow-gray-200 rounded-xl dark:shadow-gray-900/20"--}}
{{--                                     src="https://images.unsplash.com/photo-1605629921711-2f6b00c6bbf4?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=560&h=720&q=80"--}}
{{--                                     alt="Features Image">--}}
{{--                            </div>--}}
{{--                        </div>--}}
{{--                        <!-- End Tab Content -->--}}

{{--                        <!-- SVG Element -->--}}
{{--                        <div class="hidden absolute top-0 end-0 translate-x-20 md:block lg:translate-x-20">--}}
{{--                            <svg class="w-16 h-auto text-orange-500" width="121" height="135" viewBox="0 0 121 135"--}}
{{--                                 fill="none" xmlns="http://www.w3.org/2000/svg">--}}
{{--                                <path d="M5 16.4754C11.7688 27.4499 21.2452 57.3224 5 89.0164" stroke="currentColor"--}}
{{--                                      stroke-width="10" stroke-linecap="round"/>--}}
{{--                                <path d="M33.6761 112.104C44.6984 98.1239 74.2618 57.6776 83.4821 5"--}}
{{--                                      stroke="currentColor" stroke-width="10" stroke-linecap="round"/>--}}
{{--                                <path d="M50.5525 130C68.2064 127.495 110.731 117.541 116 78.0874" stroke="currentColor"--}}
{{--                                      stroke-width="10" stroke-linecap="round"/>--}}
{{--                            </svg>--}}
{{--                        </div>--}}
{{--                        <!-- End SVG Element -->--}}
{{--                    </div>--}}
{{--                </div>--}}
{{--                <!-- End Col -->--}}
{{--            </div>--}}
{{--            <!-- End Grid -->--}}

{{--            <!-- Background Color -->--}}
{{--            <div class="absolute inset-0 grid grid-cols-12 size-full">--}}
{{--                <div--}}
{{--                    class="col-span-full lg:col-span-7 lg:col-start-6 bg-gray-100 w-full h-5/6 rounded-xl sm:h-3/4 lg:h-full dark:bg-neutral-800"></div>--}}
{{--            </div>--}}
{{--            <!-- End Background Color -->--}}
{{--        </div>--}}
{{--    </div>--}}
{{--    <!-- End Features -->--}}
    <!-- Seiten-Inhalt -->
    <div class="max-w-[85rem] px-4 py-10 sm:px-6 lg:px-8 lg:py-14 mx-auto bg-pink-100 border-2 overflow-hidden">

        <!-- LEVEL-AUSWAHL -->
        <div class="mb-6">
            <h2 class="text-xl font-bold mb-4">Wähle dein Level</h2>
            <div id="level-selection" class="flex flex-wrap gap-2">
                <!-- 12 Buttons für 12 Levels -->
                <button
                    class="level-btn rounded-full bg-blue-500 text-white w-10 h-10 hover:bg-blue-600 focus:outline-hidden"
                    data-level="1">1
                </button>
                <button
                    class="level-btn rounded-full bg-blue-500 text-white w-10 h-10 hover:bg-blue-600 focus:outline-hidden"
                    data-level="2">2
                </button>
                <button
                    class="level-btn rounded-full bg-blue-500 text-white w-10 h-10 hover:bg-blue-600 focus:outline-hidden"
                    data-level="3">3
                </button>
                <button
                    class="level-btn rounded-full bg-blue-500 text-white w-10 h-10 hover:bg-blue-600 focus:outline-hidden"
                    data-level="4">4
                </button>
                <button
                    class="level-btn rounded-full bg-blue-500 text-white w-10 h-10 hover:bg-blue-600 focus:outline-hidden"
                    data-level="5">5
                </button>
                <button
                    class="level-btn rounded-full bg-blue-500 text-white w-10 h-10 hover:bg-blue-600 focus:outline-hidden"
                    data-level="6">6
                </button>
                <button
                    class="level-btn rounded-full bg-blue-500 text-white w-10 h-10 hover:bg-blue-600 focus:outline-hidden"
                    data-level="7">7
                </button>
                <button
                    class="level-btn rounded-full bg-blue-500 text-white w-10 h-10 hover:bg-blue-600 focus:outline-hidden"
                    data-level="8">8
                </button>
                <button
                    class="level-btn rounded-full bg-blue-500 text-white w-10 h-10 hover:bg-blue-600 focus:outline-hidden"
                    data-level="9">9
                </button>
                <button
                    class="level-btn rounded-full bg-blue-500 text-white w-10 h-10 hover:bg-blue-600 focus:outline-hidden"
                    data-level="10">10
                </button>
                <button
                    class="level-btn rounded-full bg-blue-500 text-white w-10 h-10 hover:bg-blue-600 focus:outline-hidden"
                    data-level="11">11
                </button>
                <button
                    class="level-btn rounded-full bg-blue-500 text-white w-10 h-10 hover:bg-blue-600 focus:outline-hidden"
                    data-level="12">12
                </button>
            </div>
        </div>
        <!-- Ende LEVEL-AUSWAHL -->

        <!-- Grid -->
        <div class="grid sm:grid-cols-2 sm:items-center gap-8">
            <!-- IMAGE on top for mobile, on the right for desktop -->
            <div class="order-1 sm:order-2">
                <div class="relative pt-[50%] sm:pt-[100%] rounded-lg">
                    <img
                        class="size-full absolute top-0 start-0 w-full h-full object-cover rounded-lg"
                        id="situation-image"
                        src=""
                        alt="Scenario Image"
                    >
                </div>
            </div>
            <!-- End Image Col -->

            <!-- QUIZ on bottom for mobile, on the left for desktop -->
            <div class="order-2 sm:order-1 space-y-6">
                <h2
                    class="text-2xl font-bold md:text-3xl lg:text-4xl lg:leading-tight xl:text-5xl xl:leading-tight text-gray-800 dark:text-neutral-200"
                    id="situation-title"
                >
                    Situation-Titel
                </h2>

                <!-- Answer Slots -->
                <div>
                    <h3 class="text-lg font-semibold text-gray-700 dark:text-neutral-200 mb-2">
                        Antwort-Slots
                    </h3>
                    <div id="answer-slots" class="grid grid-cols-1 sm:grid-cols-2 gap-2">
                        <div
                            class="slot border rounded-sm p-2 text-gray-800 dark:text-neutral-100 bg-white dark:bg-neutral-700"
                            data-slot="0"
                            data-selected-index="-1"
                        >
                            1. (Leer)
                        </div>
                        <div
                            class="slot border rounded-sm p-2 text-gray-800 dark:text-neutral-100 bg-white dark:bg-neutral-700"
                            data-slot="1"
                            data-selected-index="-1"
                        >
                            2. (Leer)
                        </div>
                        <div
                            class="slot border rounded-sm p-2 text-gray-800 dark:text-neutral-100 bg-white dark:bg-neutral-700"
                            data-slot="2"
                            data-selected-index="-1"
                        >
                            3. (Leer)
                        </div>
                        <div
                            class="slot border rounded-sm p-2 text-gray-800 dark:text-neutral-100 bg-white dark:bg-neutral-700"
                            data-slot="3"
                            data-selected-index="-1"
                        >
                            4. (Leer)
                        </div>
                        <div
                            class="slot border rounded-sm p-2 text-gray-800 dark:text-neutral-100 bg-white dark:bg-neutral-700 sm:col-span-2"
                            data-slot="4"
                            data-selected-index="-1"
                        >
                            5. (Leer)
                        </div>
                    </div>
                </div>
                <!-- End Slots -->

                <!-- Options -->
                <div>
                    <h3 class="text-lg font-semibold text-gray-700 dark:text-neutral-200 mb-2">
                        Optionen
                    </h3>
                    <div id="options-container" class="flex flex-wrap gap-2">
                        <!-- Populated by JS -->
                    </div>
                </div>
                <!-- End Options -->

                <!-- Buttons + Status -->
                <div class="flex items-center gap-4">
                    <button
                        id="check-button"
                        class="inline-flex items-center justify-center rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-xs hover:bg-blue-700"
                    >
                        Prüfen
                    </button>
                    <button
                        id="reset-button"
                        class="inline-flex items-center justify-center rounded-md border border-blue-600 bg-white px-4 py-2 text-sm font-medium text-blue-600 shadow-xs hover:bg-gray-50"
                    >
                        Neustart
                    </button>
                </div>

                <div
                    id="status-message"
                    class="font-bold text-red-600 dark:text-red-400 min-h-[1.5rem]"
                ></div>
            </div>
            <!-- End Quiz Col -->
        </div>
        <!-- End Grid -->
    </div>

    <!-- JS: Quiz Logic -->
    <script>
        // 1) Define up to 12 scenarios (hier nur beispielhaft einige dupliziert).
        //    Passen nachher natürlich auf deine wahren Szenarien an:
        const scenarios = [
            // Level 1
            {
                title: "Situation 1: Bushaltestelle",
                image: "{{ asset('images/busstation.jpg') }}",
                correctOrder: [
                    "Hallo",
                    "Mein Name ist Jake.",
                    "Ich weiß, du fragst dich: Wer ist Jack? Und was will er?",
                    "Oder du sagst dir: Warum spricht er mich an?",
                    "Oder??"
                ]
            },
            // Level 2
            {
                title: "Situation 2: Im Stadtpark",
                image: "{{ asset('images/park.jpg') }}",
                correctOrder: [
                    "Hi! Es ist so ein schöner Tag!",
                    "Mein Name ist Jake!",
                    "Du fragst dich bestimmt warum ich mich vorstelle und was ich von dir will?",
                    "Vielleicht denkst du dir.. OMG! was will der Typ von mir?",
                    "oder?"
                ]
            },
            // Level 3
            {
                title: "Situation 3: Am Bahnhof",
                image: "{{ asset('images/bahnhof.jpg') }}",
                correctOrder: [
                    "Wow, was für ein schönes Lächeln?",
                    "Ich bin Jake!",
                    "Es quatchen dich bestimmt viele Typen an",
                    "Und du denkt dir. Schon wieder einer, was will dieser von mir?",
                    "stimmts?"
                ]
            },
            // Level 4
            {
                title: "Situation 4: Im Supermarkt",
                image: "{{ asset('images/supermarkt.jpg') }}",
                correctOrder: [
                    "Hallo, kann ich kurz vorbei?",
                    "Ich brauche nur eine Packung Milch.",
                    "Hast du vielleicht schon gesehen, wo die Eier stehen?",
                    "Ach, dort hinten im Regal!",
                    "Danke, bis dann!"
                ]
            },
            // Level 5
            {
                title: "Situation 5: Beim Bäcker",
                image: "{{ asset('images/baeckerei.jpg') }}",
                correctOrder: [
                    "Guten Morgen!",
                    "Ich nehme zwei Brötchen.",
                    "Kannst du mir noch ein Croissant dazugeben?",
                    "Danke, das wäre alles.",
                    "Schönen Tag noch!"
                ]
            },
            // Level 6
            {
                title: "Situation 6: Am Strand",
                image: "{{ asset('images/strand.jpg') }}",
                correctOrder: [
                    "Wow, hier ist es richtig warm.",
                    "Ich liebe das Meeresrauschen.",
                    "Hast du schon ein kühles Getränk?",
                    "Ich gehe später schwimmen.",
                    "Willst du mitkommen?"
                ]
            },
            // Level 7 (Beispiel: Wiederholung oder etwas Neues)
            {
                title: "Situation 7: Bushaltestelle (2)",
                image: "{{ asset('images/busstation.jpg') }}",
                correctOrder: [
                    "Level 7 Satz 1",
                    "Level 7 Satz 2",
                    "Level 7 Satz 3",
                    "Level 7 Satz 4",
                    "Level 7 Satz 5"
                ]
            },
            // Level 8
            {
                title: "Situation 8: Im Stadtpark (2)",
                image: "{{ asset('images/park.jpg') }}",
                correctOrder: [
                    "Level 8 Satz 1",
                    "Level 8 Satz 2",
                    "Level 8 Satz 3",
                    "Level 8 Satz 4",
                    "Level 8 Satz 5"
                ]
            },
            // Level 9
            {
                title: "Situation 9: Am Bahnhof (2)",
                image: "{{ asset('images/bahnhof.jpg') }}",
                correctOrder: [
                    "Level 9 Satz 1",
                    "Level 9 Satz 2",
                    "Level 9 Satz 3",
                    "Level 9 Satz 4",
                    "Level 9 Satz 5"
                ]
            },
            // Level 10
            {
                title: "Situation 10: Im Supermarkt (2)",
                image: "{{ asset('images/supermarkt.jpg') }}",
                correctOrder: [
                    "Level 10 Satz 1",
                    "Level 10 Satz 2",
                    "Level 10 Satz 3",
                    "Level 10 Satz 4",
                    "Level 10 Satz 5"
                ]
            },
            // Level 11
            {
                title: "Situation 11: Beim Bäcker (2)",
                image: "{{ asset('images/baeckerei.jpg') }}",
                correctOrder: [
                    "Level 11 Satz 1",
                    "Level 11 Satz 2",
                    "Level 11 Satz 3",
                    "Level 11 Satz 4",
                    "Level 11 Satz 5"
                ]
            },
            // Level 12
            {
                title: "Situation 12: Am Strand (2)",
                image: "{{ asset('images/strand.jpg') }}",
                correctOrder: [
                    "Level 12 Satz 1",
                    "Level 12 Satz 2",
                    "Level 12 Satz 3",
                    "Level 12 Satz 4",
                    "Level 12 Satz 5"
                ]
            },
        ];

        let currentScenarioIndex = 0;
        let shuffledSentences = [];

        // Grab DOM elements
        const situationTitle = document.getElementById('situation-title');
        const situationImage = document.getElementById('situation-image');
        const slotsContainer = document.getElementById('answer-slots');
        const optionsContainer = document.getElementById('options-container');
        const checkButton = document.getElementById('check-button');
        const resetButton = document.getElementById('reset-button');
        const statusMessage = document.getElementById('status-message');

        // Level-Buttons
        const levelButtons = document.querySelectorAll('.level-btn');

        // On page load
        window.onload = () => {
            // Falls du willst, dass beim Laden direkt Level 1 startet:
            initScenario(0);
        };

        // LEVEL-AUSWAHL-KLICK
        levelButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                const level = parseInt(btn.getAttribute('data-level'), 10);
                // Level 1 -> Index 0, Level 2 -> Index 1, ...
                initScenario(level - 1);
            });
        });

        // FUNCTIONS
        function initScenario(index) {
            if (index < 0 || index >= scenarios.length) return;
            currentScenarioIndex = index;

            const scenario = scenarios[index];
            situationTitle.textContent = scenario.title;
            situationImage.src = scenario.image;

            // Clear & fill
            clearSlots();
            shuffledSentences = shuffleArray([...scenario.correctOrder]);
            renderOptions(shuffledSentences);

            statusMessage.textContent = "";
        }

        function clearSlots() {
            const slotDivs = slotsContainer.querySelectorAll('.slot');
            slotDivs.forEach((slot, idx) => {
                slot.textContent = (idx + 1) + ". (Leer)";
                slot.setAttribute('data-selected-index', '-1');
            });
        }

        function renderOptions(sentences) {
            optionsContainer.innerHTML = "";
            sentences.forEach((sentence, index) => {
                const div = document.createElement('div');
                div.classList.add(
                    'option',
                    'border',
                    'rounded-sm',
                    'p-2',
                    'cursor-pointer',
                    'hover:bg-gray-100',
                    'transition'
                );
                div.textContent = sentence;

                div.setAttribute('data-index', index);
                div.setAttribute('data-selected', 'false');

                optionsContainer.appendChild(div);
            });
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function checkOrder() {
            const scenario = scenarios[currentScenarioIndex];
            const correctOrder = scenario.correctOrder;
            const slotDivs = slotsContainer.querySelectorAll('.slot');
            const userOrder = [];

            slotDivs.forEach(slot => {
                const selectedIndex = parseInt(slot.getAttribute('data-selected-index'), 10);
                if (selectedIndex === -1) {
                    userOrder.push(null);
                } else {
                    userOrder.push(shuffledSentences[selectedIndex]);
                }
            });

            // All filled?
            if (userOrder.includes(null)) {
                statusMessage.textContent = "Bitte alle Slots befüllen!";
                return;
            }

            // Compare
            for (let i = 0; i < correctOrder.length; i++) {
                if (userOrder[i] !== correctOrder[i]) {
                    statusMessage.textContent = "Falsche Reihenfolge! Game Over!";
                    return;
                }
            }

            // Correct
            if (currentScenarioIndex < scenarios.length - 1) {
                statusMessage.textContent = "Richtig! Weiter zur nächsten Situation...";
                setTimeout(() => {
                    initScenario(currentScenarioIndex + 1);
                }, 1500);
            } else {
                statusMessage.textContent = "Gratulation! Du hast alle Situationen gemeistert!";
            }
        }

        // EVENT LISTENERS
        checkButton.addEventListener('click', checkOrder);

        resetButton.addEventListener('click', () => {
            initScenario(currentScenarioIndex);
        });

        optionsContainer.addEventListener('click', (e) => {
            if (e.target.classList.contains('option')) {
                const optionDiv = e.target;
                const isSelected = optionDiv.getAttribute('data-selected') === 'true';
                const index = parseInt(optionDiv.getAttribute('data-index'), 10);

                if (!isSelected) {
                    const freeSlot = findFreeSlot();
                    if (freeSlot) {
                        fillSlot(freeSlot, index);
                        optionDiv.classList.add('opacity-50');
                        optionDiv.setAttribute('data-selected', 'true');
                    } else {
                        statusMessage.textContent = "Alle Slots sind belegt.";
                    }
                } else {
                    removeFromSlot(index);
                    optionDiv.classList.remove('opacity-50');
                    optionDiv.setAttribute('data-selected', 'false');
                }
            }
        });

        slotsContainer.addEventListener('click', (e) => {
            if (e.target.classList.contains('slot')) {
                const selectedIndex = parseInt(e.target.getAttribute('data-selected-index'), 10);
                if (selectedIndex !== -1) {
                    removeFromSlot(selectedIndex);
                }
            }
        });

        function findFreeSlot() {
            const slotDivs = slotsContainer.querySelectorAll('.slot');
            for (let slot of slotDivs) {
                const selectedIndex = parseInt(slot.getAttribute('data-selected-index'), 10);
                if (selectedIndex === -1) {
                    return slot;
                }
            }
            return null;
        }

        function fillSlot(slotElem, optionIndex) {
            const slotNumber = parseInt(slotElem.getAttribute('data-slot'), 10) + 1;
            slotElem.textContent = slotNumber + ". " + shuffledSentences[optionIndex];
            slotElem.setAttribute('data-selected-index', optionIndex.toString());
        }

        function removeFromSlot(optionIndex) {
            // Clear the slot
            const slotDivs = slotsContainer.querySelectorAll('.slot');
            for (let slot of slotDivs) {
                if (parseInt(slot.getAttribute('data-selected-index'), 10) === optionIndex) {
                    const slotNumber = parseInt(slot.getAttribute('data-slot'), 10) + 1;
                    slot.textContent = slotNumber + ". (Leer)";
                    slot.setAttribute('data-selected-index', '-1');
                    break;
                }
            }
            // Reactivate option
            const optionDivs = optionsContainer.querySelectorAll('.option');
            for (let opt of optionDivs) {
                if (parseInt(opt.getAttribute('data-index'), 10) === optionIndex) {
                    opt.classList.remove('opacity-50');
                    opt.setAttribute('data-selected', 'false');
                    break;
                }
            }
        }
    </script>
</x-game-layout>
